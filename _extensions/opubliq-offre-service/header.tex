% load packages
\usepackage{geometry}
\usepackage{xcolor}
\usepackage{eso-pic}
\usepackage{fancyhdr}
\usepackage{sectsty}
\usepackage{fontspec}
\usepackage{titlesec}
\usepackage{enumitem}
\usepackage[colorlinks=true,
    linkcolor=dark,
    urlcolor=highlight,
    citecolor=dark
]{hyperref}

%% Set page size with a wider right margin
\geometry{a4paper, total={140mm,257mm}, left=20mm, top=20mm, bottom=20mm, right=50mm}

%% Define Opubliq colours
\definecolor{light}{HTML}{0d8491}
\definecolor{highlight}{HTML}{e6f9fa}
\definecolor{dark}{HTML}{012326}

%% Add border on the right hand side with logo
\AddToShipoutPicture{%
    \AtPageLowerLeft{%
        \put(\LenToUnit{\dimexpr\paperwidth-3cm},-1mm){%
            \color{dark}\rule{3.2cm}{\LenToUnit{\dimexpr\paperheight+2mm}}%
          }%
     }%
     % logo
    \AtPageLowerLeft{%
        \put(\LenToUnit{\dimexpr\paperwidth-2.65cm},27.2cm){%
            \color{dark}\includegraphics[width=2.5cm]{_extensions/opubliq/opubliq-offre-service/logo_color.png}
          }%
     }%
}

%% Style the page number
\fancypagestyle{mystyle}{
  \fancyhf{}
  \renewcommand\headrulewidth{0pt}
  \fancyfoot[R]{\textcolor{white}{\thepage}}
  \fancyfootoffset{3.5cm}
}
\setlength{\footskip}{20pt}

%% style the chapter/section fonts
\chapterfont{\color{dark}\fontsize{20}{16.8}\selectfont}
\sectionfont{\color{dark}\fontsize{20}{16.8}\selectfont}
\subsectionfont{\color{dark}\fontsize{14}{16.8}\selectfont}
\titleformat{\subsection}
  {\sffamily\Large\bfseries}{\thesubsection}{1em}{}[{\titlerule[0.8pt]}]

% left align title
\makeatletter
\renewcommand{\maketitle}{\bgroup\setlength{\parindent}{0pt}
\begin{flushleft}
\sffamily\fontsize{45}{50}\selectfont
\setlength{\baselineskip}{50pt}
\textbf{\textcolor{dark}{\MakeUppercase{\@title}}}\\[0.8cm]
{\sffamily\fontsize{35}{38}\selectfont
\setlength{\baselineskip}{38pt}
\textcolor{dark}{\@subtitle}} \newline
  \textcolor{dark}{\@author}
\end{flushleft}\egroup
}
\makeatother

%% Use Ubuntu fonts
\setsansfont{Ubuntu}[
    Path=_extensions/opubliq/opubliq-offre-service/Ubuntu/,
    Scale=0.9,
    Extension = .ttf,
    UprightFont=*-Regular,
    BoldFont=*-Bold,
    ItalicFont=*-Italic,
    ]

\setmainfont{Ubuntu}[
    Path=_extensions/opubliq/opubliq-offre-service/Ubuntu/,
    Scale=0.9,
    Extension = .ttf,
    UprightFont=*-Regular,
    BoldFont=*-Bold,
    ItalicFont=*-Italic,
    ]

\setcounter{secnumdepth}{2}
